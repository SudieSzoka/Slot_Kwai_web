(function(root){var exports=undefined,module=undefined,require=undefined;var define=undefined;var self=root,window=root,global=root,globalThis=root;(function(){/* ===========================================================
 * KS_SDK Build (Production), Version: KSSDK_202511121656_V1.0
 * Build Time: 202511121656
 * =========================================================== */var KS_SDK=(()=>{var Pt=Object.defineProperty;var Mt=(O,e,i)=>e in O?Pt(O,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):O[e]=i;var F=(O,e,i)=>Mt(O,typeof e!="symbol"?e+"":e,i);(function(){var O=function(){if(typeof KSGameGlobal!="undefined")return KSGameGlobal;if(typeof cc!="undefined"&&cc.sys&&cc.sys.global)return cc.sys.global;if(typeof window!="undefined")return window;if(typeof self!="undefined")return self;if(typeof global!="undefined")return global;try{return Function("return this")();}catch{return console.warn("[KS_SDK] \u65E0\u6CD5\u5B9A\u4F4D\u5168\u5C40\u5BF9\u8C61\uFF0C\u4F7F\u7528\u7A7A\u5BF9\u8C61"),{};}},e=O();typeof e.globalThis=="undefined"&&(e.globalThis=e),console.log("[KS_SDK] \u68C0\u6D4B\u5230\u8FD0\u884C\u73AF\u5883:",{hasKSGameGlobal:typeof KSGameGlobal!="undefined",hasCcSysGlobal:typeof cc!="undefined"&&cc.sys&&cc.sys.global,hasWindow:typeof window!="undefined",hasSelf:typeof self!="undefined",hasGlobal:typeof global!="undefined",globalObject:e.constructor.name});})();typeof globalThis.crypto=="undefined"&&(globalThis.crypto={});typeof globalThis.crypto.getRandomValues!="function"&&(globalThis.crypto.getRandomValues=function(O){if(!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");for(let e=0;e<O.length;e++)O[e]=Math.floor(Math.random()*256);return O;});(function(){if(typeof globalThis.TextEncoder=="undefined"){class O{constructor(i="utf-8"){if(i.toLowerCase()!=="utf-8")throw new Error("Only utf-8 encoding is supported in TextEncoder polyfill.");}encode(i){let a=[];for(let c=0;c<i.length;c++){let w=i.charCodeAt(c);w<128?a.push(w):w<2048?a.push(192|w>>6,128|w&63):w<55296||w>=57344?a.push(224|w>>12,128|w>>6&63,128|w&63):(c++,w=65536+((w&1023)<<10|i.charCodeAt(c)&1023),a.push(240|w>>18,128|w>>12&63,128|w>>6&63,128|w&63));}return new Uint8Array(a);}}globalThis.TextEncoder=O;}if(typeof globalThis.TextDecoder=="undefined"){class O{constructor(i="utf-8"){if(i.toLowerCase()!=="utf-8")throw new Error("Only utf-8 encoding is supported in TextDecoder polyfill.");}decode(i){let a="",c=0,w=i.length;for(;c<w;){let b=i[c++];if(b>>4<=7)a+=String.fromCharCode(b);else if(b>>4===12||b>>4===13){let U=i[c++];a+=String.fromCharCode((b&31)<<6|U&63);}else if(b>>4===14){let U=i[c++],E=i[c++];a+=String.fromCharCode((b&15)<<12|(U&63)<<6|E&63);}else{let U=i[c++],E=i[c++],B=i[c++],H=(b&7)<<18|(U&63)<<12|(E&63)<<6|B&63;H-=65536,a+=String.fromCharCode(55296+(H>>10),56320+(H&1023));}}return a;}}globalThis.TextDecoder=O;}})();var ye=class{static formatTimeNew(){let e=new Date();return[this.padZero(e.getHours()),this.padZero(e.getMinutes()),this.padZero(e.getSeconds())].join(":");}static padZero(e){return e<10?`0${e}`:e.toString();}static shouldLog(e){return this.config.enabled?this.levelWeights[e]>=this.levelWeights[this.config.minLevel]:!1;}static log(e,i,...a){if(!this.shouldLog(e))return;let c=this.formatTimeNew(),w=`[${e.toUpperCase().charAt(0)}]`,b=`[${c}] ${w}`;switch(e){case"debug":console.log(b,i,...a);break;case"info":console.info(b,i,...a);break;case"warn":console.warn(b,i,...a);break;case"error":console.error(b,i,...a);break;}}static debug(e,...i){this.log("debug",e,...i);}static info(e,...i){this.log("info",e,...i);}static warn(e,...i){this.log("warn",e,...i);}static error(e,...i){this.log("error",e,...i);}static setEnabled(e){this.config.enabled=e;}static setMinLevel(e){this.config.minLevel=e;}};ye.config={enabled:!0,minLevel:"debug"},ye.levelWeights={debug:0,info:1,warn:2,error:3};var l=ye;var we=typeof KSGameGlobal!="undefined"||typeof ks!="undefined",be=class O{constructor(e){this._maxConcurrentRequests=10;this._defaultTimeout=8;this._maxRetryCount=2;this._requestQueue=[];this._activeRequests=0;this._activeRequestsMap=new Map();this._requestTimeouts=new Map();this._isShuttingDown=!1;var i,a,c;e&&(this._maxConcurrentRequests=(i=e.maxConcurrentRequests)!=null?i:this._maxConcurrentRequests,this._defaultTimeout=(a=e.defaultTimeout)!=null?a:this._defaultTimeout,this._maxRetryCount=(c=e.maxRetryCount)!=null?c:this._maxRetryCount),!we&&typeof window!="undefined"&&window.addEventListener("beforeunload",()=>this.shutdown());}static get instance(){return this._instance||(this._instance=new O()),this._instance;}static initialize(e){return this._instance&&(l.warn("HttpRequestTool\u5DF2\u521D\u59CB\u5316\uFF0C\u5C06\u91CD\u65B0\u521B\u5EFA\u65B0\u5B9E\u4F8B"),this._instance.shutdown()),this._instance=new O(e),this._instance;}sendRequest(e,i="GET",a,c,w,b,U){if(this._isShuttingDown)return l.warn("HttpRequestTool\u6B63\u5728\u5173\u95ED\uFF0C\u62D2\u7EDD\u65B0\u8BF7\u6C42"),"";let E=this.generateRequestId(),B={requestId:E,url:e,method:i,body:a,binaryCallback:c,textCallback:w,timeout:b!=null?b:this._defaultTimeout,retryCount:this._maxRetryCount,headers:U,retryAttempt:0};return this._activeRequests<this._maxConcurrentRequests?(this._activeRequests++,this.executeRequest(B)):this._requestQueue.push(B),E;}sendTextRequest(e,i="GET",a,c,w,b){let U;return a&&(U=new TextEncoder().encode(a)),this.sendRequest(e,i,U,void 0,c,w,b);}sendJsonRequest(e,i="POST",a,c,w,b){let U=a?JSON.stringify(a):void 0,E={"Content-Type":"application/json",...b};return this.sendTextRequest(e,i,U,(B,H)=>{if(c)try{let M=B&&H?JSON.parse(H):null;c(B,M);}catch(M){l.error("JSON\u89E3\u6790\u9519\u8BEF:",M),c(!1,null);}},w,E);}cancelRequest(e){var a;let i=this._activeRequestsMap.get(e);i&&(we||(a=i.abort)==null||a.call(i),this._activeRequestsMap.delete(e),this.cleanupTimeout(e));}cancelAllRequests(){this._requestQueue.length=0,this._activeRequestsMap.forEach((e,i)=>{var a;we||(a=e.abort)==null||a.call(e),this.cleanupTimeout(i);}),this._activeRequestsMap.clear(),this._activeRequests=0;}shutdown(){this._isShuttingDown=!0,this.cancelAllRequests(),this._requestTimeouts.forEach(e=>clearTimeout(e)),this._requestTimeouts.clear();}generateRequestId(){return"req_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);}executeRequest(e){we?this.executeKSRequest(e):this.executeBrowserRequest(e);}executeBrowserRequest(e){var c;let i=new XMLHttpRequest();this._activeRequestsMap.set(e.requestId,i),i.open(e.method,e.url,!0),i.timeout=e.timeout*1e3,e.headers&&Object.keys(e.headers).forEach(w=>{let b=e.headers[w];i.setRequestHeader(w,b);}),i.responseType="arraybuffer",i.onload=()=>this.handleRequestComplete(e,i,!1),i.onerror=()=>this.handleRequestComplete(e,i,!0),i.ontimeout=()=>this.handleRequestComplete(e,i,!0);let a=setTimeout(()=>{this._activeRequestsMap.has(e.requestId)&&i.abort();},e.timeout*1e3);this._requestTimeouts.set(e.requestId,a);try{i.send((c=e.body)!=null?c:null);}catch(w){l.error("\u53D1\u9001\u8BF7\u6C42\u5931\u8D25:",w),this.handleRequestComplete(e,i,!0);}}executeKSRequest(e){this._activeRequestsMap.set(e.requestId,!0);let i=e.body?e.body.buffer:void 0,a=setTimeout(()=>{this._activeRequestsMap.get(e.requestId)&&(this._activeRequestsMap.set(e.requestId,!1),this.handleRequestComplete(e,null,!0));},e.timeout*1e3);this._requestTimeouts.set(e.requestId,a),ks.request({url:e.url,method:e.method,header:e.headers,data:i,responseType:"arraybuffer",success:c=>{this._activeRequestsMap.get(e.requestId)&&this.handleRequestComplete(e,c,!1);},fail:()=>{this._activeRequestsMap.get(e.requestId)&&this.handleRequestComplete(e,null,!0);}});}handleRequestComplete(e,i,a){this.cleanupTimeout(e.requestId),this._activeRequestsMap.delete(e.requestId);let c=!1,w=null;if(we){if(c=!a&&i&&i.statusCode>=200&&i.statusCode<=400,c&&i.data)w=new Uint8Array(i.data);else if(i&&i.data){let b=new Uint8Array(i.data);this.logErrorResponse(e.url,i.statusCode,b);}}else{let b=i;c=!a&&b.status>=200&&b.status<=400,c&&b.response?w=new Uint8Array(b.response):b&&b.response&&this.logErrorResponse(e.url,b.status,b.response);}if(!c&&e.retryAttempt<e.retryCount){e.retryAttempt++,l.debug(`\u8BF7\u6C42\u5931\u8D25\uFF0C\u7B2C${e.retryAttempt}\u6B21\u91CD\u8BD5: ${e.url}`),setTimeout(()=>this.executeRequest(e),500*e.retryAttempt);return;}try{if(e.binaryCallback&&e.binaryCallback(c,w),e.textCallback){let b=w?new TextDecoder().decode(w):"";e.textCallback(c,b);}}catch(b){l.error("\u56DE\u8C03\u6267\u884C\u9519\u8BEF:",b);}this.finishRequest();}finishRequest(){if(this._activeRequests--,this._requestQueue.length>0&&this._activeRequests<this._maxConcurrentRequests){this._activeRequests++;let e=this._requestQueue.shift();this.executeRequest(e);}}cleanupTimeout(e){let i=this._requestTimeouts.get(e);i&&(clearTimeout(i),this._requestTimeouts.delete(e));}async logErrorResponse(e,i,a){try{let c;typeof a=="string"?c=a:a instanceof ArrayBuffer||a instanceof Uint8Array?(c=new TextDecoder().decode(a),c=await D.getGcmDecryptData(c)):typeof a=="object"?c=JSON.stringify(a):c=String(a);let w=c;try{let b=JSON.parse(c);w=JSON.stringify(b,null,2);}catch{}l.error(`\u8BF7\u6C42\u5931\u8D25(${i||"\u672A\u77E5\u72B6\u6001\u7801"}): ${e}
\u54CD\u5E94\u5185\u5BB9:
${w}`);}catch(c){l.error(`\u8BF7\u6C42\u5931\u8D25(${i||"\u672A\u77E5\u72B6\u6001\u7801"}): ${e}\uFF0C\u65E0\u6CD5\u89E3\u6790\u54CD\u5E94\u6570\u636E`,c);}}},Qt=be.instance;var Ft=typeof KSGameGlobal!="undefined"||typeof ks!="undefined",K=class{static init(e,i,a){if(!Ft){l.warn("\u5F53\u524D\u73AF\u5883\u975E\u5FEB\u624B\u5C0F\u6E38\u620F\uFF0CAdTool\u521D\u59CB\u5316\u5931\u8D25");return;}if(this.isInitialized){l.warn("AdTool\u5DF2\u521D\u59CB\u5316\uFF0C\u65E0\u9700\u91CD\u590D\u521D\u59CB\u5316");return;}this.isInitialized=!0,this.ksBannerUnitId=a,this.ksInterUnitId=e,this.ksVideoUnitId=i,this.initBannerAd(),this.initInterstitialAd(),this.initVideoAd();}static initBannerAd(){if(l.debug("AdTool init banner : "+this.ksBannerUnitId),!this.isValidString(this.ksBannerUnitId)){l.warn("AdTool Banner Ad Unit ID is invalid");return;}let{windowWidth:e,windowHeight:i}=ks.getSystemInfoSync(),a=320;this.ksBannerAd=ks.createBannerAd({adUnitId:this.ksBannerUnitId,style:{width:a,left:(e-a)/2,top:i-a/5}}),this.ksBannerAd.onError(c=>{this.handleError(c,"initBanner");}),this.ksBannerAd.onResize(c=>{l.debug("AdTool Banner Ad Resized: ",c);}),this.ksBannerAd.onLoad(()=>{l.debug("AdTool Banner Ad Loaded");}),this.ksBannerAd.show().then(function(){l.debug("show banner ad success");}).catch(function(c){l.error("show banner ad failed, error is ",c);});}static initInterstitialAd(){if(l.debug("AdTool init inter : "+this.ksInterUnitId),!this.isValidString(this.ksInterUnitId)){l.warn("AdTool Interstitial Ad Unit ID is invalid");return;}this.ksInterAd=ks.createInterstitialAd({adUnitId:this.ksInterUnitId}),this.ksInterAd.onError(e=>{this.handleError(e,"initInter");}),this.ksInterAd.onClose(e=>{l.debug("AdTool Interstitial Ad Closed: ",e),this.adReward!=null&&this.isAdShowSuccess&&(l.debug("\u6267\u884C\u56DE\u8C03 inter adReward"),this.adReward.call(),this.adReward=null,this.isAdShowSuccess=!1),this.adHide!=null&&(l.debug("\u6267\u884C\u9690\u85CF\u56DE\u8C03 inter adHide"),this.adHide.call(),this.adHide=null);});}static initVideoAd(){if(l.debug("AdTool init video : "+this.ksVideoUnitId),!this.isValidString(this.ksVideoUnitId)){l.warn("AdTool Video Ad Unit ID is invalid");return;}this.ksVideoAd=ks.createRewardedVideoAd({adUnitId:this.ksVideoUnitId}),this.ksVideoAd.onClose(e=>{l.debug("AdTool Video Ad Closed isEnded: ",e&&e.isEnded),this.adReward!=null&&this.isAdShowSuccess&&(l.debug("\u6267\u884C\u5956\u52B1\u56DE\u8C03 Video Ad adReward"),this.adReward.call(),this.adReward=null,this.isAdShowSuccess=!1),this.adHide!=null&&(l.debug("\u6267\u884C\u9690\u85CF\u56DE\u8C03 Video Ad adHide"),this.adHide.call(),this.adHide=null);}),this.ksVideoAd.onError(e=>{this.handleError(e,"initVideo");}),this.ksVideoAd.onLoad(()=>{l.debug("AdTool Video Ad Loaded");});}static showBannerAd(){l.debug("Showing Banner Ad...",this.ksBannerAd),this.ksBannerAd?(this.ksBannerAd.hide(),this.ksBannerAd.show().then(()=>{l.debug("\u6A2A\u5E45 \u5E7F\u544A\u663E\u793A");}).catch(e=>{this.handleError(e,"ksBannerAd.show");})):(l.debug("ks banner ad is null, re-initialize it."),this.initBannerAd());}static hideBannerAd(){l.debug("Hiding Banner Ad"),this.ksBannerAd&&this.ksBannerAd.hide().then(()=>{l.debug("\u6A2A\u5E45 \u5E7F\u544A\u9690\u85CF");}).catch(e=>{this.handleError(e,"ksBannerAd.hide");});}static destroyBannerAd(){l.debug("Destroying Banner Ad"),this.ksBannerAd&&(this.ksBannerAd.destroy(),this.ksBannerAd=null,l.debug("\u6A2A\u5E45 \u5E7F\u544A\u9500\u6BC1"));}static showInterAd(e,i=null,a=null){l.debug("showInterAd called"),this.adHide=i,this.ksInterAd?(this.isAdShowSuccess=!1,this.adReward=a,l.debug("Showing Interstitial Ad...",this.ksInterAd),_.trackShowOk("ins",e),this.ksInterAd.show().then(()=>{l.debug("\u63D2\u5C4F \u5E7F\u544A\u663E\u793A"),this.isAdShowSuccess=!0,_.trackShowFinishOk("ins",e,this.ksInterUnitId);}).catch(c=>{this.handleError(c,"showInterAd"),this.adHide!=null&&(l.debug("\u6267\u884C\u9690\u85CF\u56DE\u8C03 Inter adHide"),this.adHide.call(),this.adHide=null),_.trackShowFinishFail("ins",e,c.message||JSON.stringify(c),this.ksInterUnitId);})):(l.debug("ks inter ad is null, re-initialize it."),this.initInterstitialAd(),this.adHide!=null&&(l.debug("\u6267\u884C\u9690\u85CF\u56DE\u8C03 InteradHide"),this.adHide.call(),this.adHide=null),_.trackShowFail("ins",e,"ksInterAd is null"));}static showVideoAd(e,i=null,a=null){l.debug("showVideoAd called"),this.adHide=i,this.ksVideoAd?(this.adReward=a,this.isAdShowSuccess=!1,l.debug("Showing Video Ad...",this.ksVideoAd),_.trackShowOk("rewarded",e),this.ksVideoAd.show().then(()=>{l.debug("\u6FC0\u52B1 \u5E7F\u544A\u663E\u793A"),this.isAdShowSuccess=!0,_.trackShowFinishOk("rewarded",e,this.ksVideoUnitId);}).catch(c=>{this.handleError(c,"ksVideoAd.show"),this.adHide!=null&&(l.debug("\u6267\u884C\u9690\u85CF\u56DE\u8C03Reward Video adHide"),this.adHide.call(),this.adHide=null),_.trackShowFinishFail("rewarded",e,c.message||JSON.stringify(c),this.ksVideoUnitId);})):(l.debug("ks video ad is null, re-initialize it."),this.initVideoAd(),this.adHide!=null&&(l.debug("\u6267\u884C\u9690\u85CF\u56DE\u8C03Reward Video adHide"),this.adHide.call(),this.adHide=null),_.trackShowFail("rewarded",e,"ksVideoAd is null"));}static showInterFirstElseVideo(e,i=null,a=null){l.debug("showInterFirstElseVideo called"),this.adHide=i,this.ksInterAd?(this.isAdShowSuccess=!1,this.adReward=a,l.debug("Showing Interstitial Ad...",this.ksInterAd),_.trackShowOk("ins",e),this.ksInterAd.show().then(()=>{l.debug("\u63D2\u5C4F \u5E7F\u544A\u663E\u793A"),this.isAdShowSuccess=!0,_.trackShowFinishOk("ins",e,this.ksInterUnitId);}).catch(c=>{this.handleError(c,"showInterAd"),l.debug("Interstitial Ad show failed, try to show Video Ad"),this.showVideoAd(e,this.adHide,this.adReward),_.trackShowFinishFail("ins",e,c.message||JSON.stringify(c),this.ksInterUnitId);})):(l.debug("ks inter ad is null, re-initialize it."),this.initInterstitialAd(),l.debug("Interstitial Ad show failed, try to show Video Ad"),this.showVideoAd(e,this.adHide,this.adReward),_.trackShowFail("ins",e,"ksInterAd is null, re-initialize it. Interstitial Ad show failed, try to show Video Ad"));}static showVideoFirstElseInter(e,i=null,a=null){l.debug("showVideoFirstElseInter called"),this.adHide=i,this.ksVideoAd?(this.adReward=a,this.isAdShowSuccess=!1,l.debug("Showing Video Ad...",this.ksVideoAd),_.trackShowOk("rewarded",e),this.ksVideoAd.show().then(()=>{l.debug("\u6FC0\u52B1 \u5E7F\u544A\u663E\u793A"),this.isAdShowSuccess=!0,_.trackShowFinishOk("rewarded",e,this.ksVideoUnitId);}).catch(c=>{this.handleError(c,"ksVideoAd.show"),l.debug("Video Ad show failed, try to show Interstitial Ad"),this.showInterAd(e,this.adHide,this.adReward),_.trackShowFinishFail("rewarded",e,c.message||JSON.stringify(c),this.ksVideoUnitId);})):(l.debug("ks video ad is null, re-initialize it."),this.initVideoAd(),l.debug("Video Ad show failed, try to show Interstitial Ad"),this.showInterAd(e,this.adHide,this.adReward),_.trackShowFail("rewarded",e,"ksVideoAd is null, re-initialize it. Video Ad show failed, try to show Interstitial Ad"));}static isValidString(e){return typeof e=="string"&&e.trim().length>0;}static handleError(e,i){e instanceof Error?l.error(`\u5E7F\u544A\u9519\u8BEF(Error\u7C7B\u578B) [${i}]:`,{message:e.message,stack:e.stack,name:e.name}):typeof e=="object"&&e!==null?l.error(`\u5E7F\u544A\u9519\u8BEF(\u5BF9\u8C61\u7C7B\u578B) [${i}]:`,{...e,raw:JSON.stringify(e,Object.getOwnPropertyNames(e),2)}):l.error(`\u5E7F\u544A\u9519\u8BEF(\u5176\u4ED6\u7C7B\u578B) [${i}]:`,e);}};K.ksBannerAd=null,K.ksInterAd=null,K.ksVideoAd=null,K.adHide=null,K.adReward=null,K.isInitialized=!1,K.isAdShowSuccess=!1,K.ksBannerUnitId="",K.ksInterUnitId="",K.ksVideoUnitId="";var Re=class{constructor(){this.isDebug=!1;this.configUrl="";this.appKey="";this.appSecret="";this.bannerAdId="";this.interstitialAdId="";this.videoAdId="";}},re=class{static init(e){this.config=e,l.setEnabled(this.config.isDebug),l.debug("SDKMgr initialized with version ---> ",this.VERSION),D.initialize(this.config.configUrl,this.config.appKey,this.config.appSecret),C.init(),_.init(),K.init(this.config.interstitialAdId,this.config.videoAdId,this.config.bannerAdId);}static getConfigObj(){return this.config;}static getConfigData(e,i){D.getConfig(e,a=>{i(!0,a);},()=>{i(!1,"");});}static getwithdrawConfig(e){D.getwithdrawConfig(e);}static createOrder(e,i){D.createOrder(e,i);}static getOrder(e){D.getOrder(e);}static track(e,i){_.track(e,i);}static showInter(e,i=null,a=null){K.showInterAd(e,i,a);}static showVideo(e,i=null,a=null){K.showVideoAd(e,i,a);}static showVideoFirstElseInter(e,i=null,a=null){K.showVideoFirstElseInter(e,i,a);}static showInterFirstElseVideo(e,i=null,a=null){K.showInterFirstElseVideo(e,i,a);}static showBanner(){K.showBannerAd();}static hideBanner(){K.hideBannerAd();}static share(e,i,a){C.share(e,i,a);}static addToDesktop(e,i,a){C.addToDesktop(e,i,a);}static checkShortcut(e=null){C.checkShortcut(e);}static saveToFavorites(e,i,a){C.saveToFavorites(e,i,a);}};re.VERSION="KSSDK_202511121656_V1.0",re.config=new Re();(function(){let O=!1;function e(){if(!O){O=!0;try{let c=typeof KSGameGlobal!="undefined"?KSGameGlobal:typeof cc!="undefined"&&cc.sys&&cc.sys.global?cc.sys.global:typeof window!="undefined"?window:typeof self!="undefined"?self:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:{};if(c)return c.KS_SDK=c.KS_SDK||{},c.KS_SDK.SDKConfig=Re,c.KS_SDK.SDKMgr=re,console.log("[KS_SDK] \u{1F527} SDK\u6838\u5FC3\u6A21\u5757\u6302\u8F7D\u5B8C\u6210\uFF0C\u7248\u672C:",re.VERSION),console.log("[KS_SDK] \u{1F4CD} \u6302\u8F7D\u4F4D\u7F6E:",c.constructor.name),!0;}catch(a){console.error("[KS_SDK] \u6302\u8F7D\u5931\u8D25:",a);}return!1;}}function i(){if(typeof cc!="undefined"&&cc.game){if(cc.game.isRunning)e();else{let a=()=>{e();};cc.game.once?cc.Game&&cc.Game.EVENT_ENGINE_INITED?cc.game.once(cc.Game.EVENT_ENGINE_INITED,a):cc.game.EVENT_ENGINE_INITED?cc.game.once(cc.game.EVENT_ENGINE_INITED,a):cc.game.once("game_inited",a):setTimeout(e,1e3);}}else typeof document!="undefined"&&document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):setTimeout(e,0);setTimeout(()=>{O||e();},3e3);}i();})();var _=class{static init(){this.trackOpenApp();}static trackOpenApp(){this.timeStamp=Date.now(),this.track("app_open",{status:"1"});}static trackFront(){this.timeStamp=Date.now(),this.track("app_front",{status:"1"});}static trackExitApp(){this.track("app_exit",{status:"1",entry_time:this.timeStamp,departure_time:Date.now()});}static trackShowOk(e,i){this.track("show_cp2sdk_success",{status:"1",ad_type:e,ad_id:i});}static trackShowFail(e,i,a){this.track("show_cp2sdk_fail",{status:"0",ad_type:e,ad_id:i,error_message:a});}static trackShowFinishOk(e,i,a){this.track("showfinish_mediation2sdk",{status:"1",ad_type:e,ad_id:i,ad_slotid:a});}static trackShowFinishFail(e,i,a,c){this.track("showfinish_mediation2sdk",{status:"0",ad_type:e,ad_id:i,error_message:a,ad_slotid:c});}static trackDomain(e){this.track("reporting_domain",{domain_name:e});}static trackGetConfig(e,i,a,c){this.track("get_config",{status:c?"1":"0",field_name:e,wait_time:i/1e3,field_value:a,result:c});}static track(e,i){if(!C.unionID&&!C.isGetUserInfo){l.debug(`\u{1F4CA} \u7F13\u5B58\u57CB\u70B9\u4E8B\u4EF6: ${e}, \u539F\u56E0\uFF1AunionID\u4E3A\u7A7A\u4E14\u672A\u83B7\u53D6\u7528\u6237\u4FE1\u606F`,i),this.trackCache.push({eventName:e,params:i!=null?i:{}});return;}let a=this.handleTrackParams(i);l.debug(`\u{1F4CA}send event name: ${e}, data:`,a),D.sendEvt(e,a);}static flushTrackCache(){let e=this.trackCache.length;return e===0?(l.debug("\u{1F4CA} \u65E0\u7F13\u5B58\u7684\u57CB\u70B9\u4E8B\u4EF6"),0):(l.debug(`\u{1F4CA} \u5F00\u59CB\u4E0A\u62A5\u7F13\u5B58\u7684 ${e} \u4E2A\u57CB\u70B9\u4E8B\u4EF6`),this.trackCache.forEach(({eventName:i,params:a})=>{let c=this.handleTrackParams(a);l.debug(`\u{1F4CA}send cached event name: ${i}, data:`,c),D.sendEvt(i,c);}),this.trackCache=[],e);}static handleTrackParams(e){let i=e!=null?e:{};return i.hasOwnProperty("country_code")||(i.country_code=C.country),i.hasOwnProperty("language")||(i.language=C.language),i.hasOwnProperty("advertising_id")||(i.advertising_id=C.unionID),i.hasOwnProperty("app_osdk_version")||(i.app_osdk_version=re.VERSION),i.hasOwnProperty("eventrequest_id")||(i.eventrequest_id=P.generateGuid()),i.hasOwnProperty("app_version")||(i.app_version=C.gameVersion),i.hasOwnProperty("app_id")||(i.app_id=C.appId),i;}};_.timeStamp=Date.now(),_.trackCache=[];var me=typeof KSGameGlobal!="undefined"||typeof ks!="undefined",N=class N{static init(){if(!me){l.warn("\u5F53\u524D\u73AF\u5883\u975E\u5FEB\u624B\u5C0F\u6E38\u620F\uFF0CKwaiApiTool\u521D\u59CB\u5316\u5931\u8D25");return;}(async()=>{try{let i=await N.ksLogin();l.debug("\u{1F389} \u767B\u5F55\u6210\u529F, code = ",i),D.getKsSession(i);}catch(i){l.error("\u767B\u5F55\u5931\u8D25:",i);}})(),this.getSystemInfo(),this.getLaunchOptionsSync(),this.addFrontOrBackListener(),this.getUserInfo(),this.reportScene();let e={country:this.country,language:this.language,appId:this.appId,from:this.from,gameVersion:this.gameVersion,platform:this.platform,env:this.env,brand:this.brand,model:this.model,kwaiSDKVerison:this.kwaiSDKVerison,system:this.system};this.cacheKsData=e,l.debug("--> cacheKsData : ",this.cacheKsData);}static saveKey(e,i){try{ks.setStorageSync(e,i);}catch(a){l.warn(`\u26A0\uFE0F ks key[${e}] setStorageSync error:`,a);}}static getKey(e){try{let i=ks.getStorageSync(e);if(i)return l.debug(`\u{1F9E9} \u8BFB\u53D6\u7F13\u5B58 ${e}:`,i),i;}catch(i){l.warn(`\u26A0\uFE0F ks key[${e}] getStorageSync error:`,i);}return null;}static async ksLogin(){try{return new Promise((e,i)=>{ks.checkSession({success:()=>{l.debug("\u2705 ks checkSession true"),this.ksCode||(this.ksCode=this.getKey(this.ks_code_key)),this.ksCode?e(this.ksCode):this.doLogin(e,i);},fail:a=>{l.warn("\u26A0\uFE0F ks checkSession fail:",a),this.doLogin(e,i);}});});}catch(e){throw l.error("\u274C KwaiApiTool ksLogin error:",e),e;}}static doLogin(e,i){ks.login({success:a=>{l.debug("\u2705 ks login success, code:",a.code),this.ksCode=a.code,this.saveKey(this.ks_code_key,a.code),e(a.code);},fail:a=>{l.error("\u274C ks login fail:",a),i(a);},complete:()=>{l.debug("ks login complete");}});}static getSystemInfo(){try{let e=ks.getSystemInfoSync();l.debug("KwaiApiTool getSystemInfo: ",e);let i=this.splitLocale(e.language);return this.country=i.country||"",this.language=i.language,this.appId=e.host.appId||"",this.gameVersion=e.host.version||e.host.gameVersion||"",this.platform=e.platform,this.env=e.host.env,this.brand=e.brand,this.model=e.model,this.kwaiSDKVerison=e.SDKVersion,this.system=e.system,e;}catch(e){return l.error("KwaiApiTool getSystemInfo error: ",e),null;}}static getLaunchOptionsSync(){try{let e=ks.getLaunchOptionsSync();return l.debug("KwaiApiTool getLaunchOptionsSync: ",e),l.debug("\u573A\u666F\u503C: ",e.from),this.from=e.from||"",e;}catch(e){return l.error("KwaiApiTool getLaunchOptionsSync error: ",e),null;}}static addFrontOrBackListener(){ks.onShow(e=>{l.debug("KwaiApiTool onShow: ",e),_.trackFront();}),ks.onHide(()=>{l.debug("KwaiApiTool onHide"),_.trackExitApp();});}static getUserInfo(){ks.getUserInfo({success:e=>{l.debug("KwaiApiTool getUserInfo success: ",e),this.unionID=e.unionID||e.userInfo.unionID,l.debug("unionID : ",this.unionID);},fail:e=>{l.error("KwaiApiTool getUserInfo fail: ",e);},complete:()=>{l.debug("\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5B8C\u6210"),this.isGetUserInfo=!0,_.flushTrackCache();}});}static splitLocale(e){var w,b;let i=e.split(/[_-]/),a=((w=i[0])==null?void 0:w.trim())||"",c=((b=i[1])==null?void 0:b.trim())||void 0;if(!a)throw new Error("\u65E0\u6548\u7684\u8BED\u8A00\u4EE3\u7801\u683C\u5F0F");return{language:a,country:c};}static reportScene(){l.debug("Reporting Scene"),this.isReport||(this.isReport=!0,ks.reportScene({sceneId:1},{success:function(e){l.debug("KwaiApiTool reportScene success:"+JSON.stringify(e));},fail:function(e){l.debug("KwaiApiTool reportScene fail:"+JSON.stringify(e)),this.isReport=!1;},complete:function(){l.debug("KwaiApiTool reportScene complete");}}));}static share(e=null,i=null,a=null){if(!me){l.debug("\u5F53\u524D\u73AF\u5883\u975E\u5FEB\u624B\u5C0F\u6E38\u620F, share \u5931\u8D25");return;}l.debug("KwaiApiTool Sharing"),_.track("share_cp2sdk"),ks.shareAppMessage({templateId:"",shareDesc:"",imageData:"",query:"",success:function(c){l.debug("KwaiApiTool Share success: "+JSON.stringify(c)),e!=null&&e.call(),_.track("share_success");},fail:function(c){l.debug("KwaiApiTool Share fail: "+JSON.stringify(c)),i!=null&&i.call();},complete:function(c){l.debug("KwaiApiTool Share complete: "+JSON.stringify(c)),a!=null&&a.call();}});}static addToDesktop(e=null,i=null,a=null){if(!me){l.debug("\u5F53\u524D\u73AF\u5883\u975E\u5FEB\u624B\u5C0F\u6E38\u620F, addToDesktop \u5931\u8D25");return;}l.debug("KwaiApiTool Adding to Desktop"),_.track("addShortcut_cp2sdk"),ks.addShortcut({success:function(c){l.debug("KwaiApiTool addShortcut success:"+JSON.stringify(c)),e!=null&&e.call(),_.track("addShortcut_success"),window.setTimeout(()=>{N.checkShortcut();},15e3);},fail:function(c){l.debug("KwaiApiTool addShortcut fail:"+JSON.stringify(c)),i!=null&&i.call();},complete:function(){l.debug("KwaiApiTool addShortcut complete"),a!=null&&a.call();}});}static checkShortcut(e=null){if(!me){l.debug("\u5F53\u524D\u73AF\u5883\u975E\u5FEB\u624B\u5C0F\u6E38\u620F, checkShortcut \u5931\u8D25");return;}l.debug("KwaiApiTool Checking Shortcut"),ks.checkShortcut({success:function(i){if(l.debug("\u63A5\u53E3\u8C03\u7528\u6210\u529F\uFF0C\u8FD4\u56DE\u6570\u636E\uFF1A",i),i.code===1){let a=i.installed;a?(l.debug("\u2705 \u5C0F\u6E38\u620F\u5FEB\u6377\u65B9\u5F0F\u5DF2\u6DFB\u52A0\u5230\u684C\u9762"),_.track("Shortcut_check_success")):l.debug("\u274C \u5C0F\u6E38\u620F\u5FEB\u6377\u65B9\u5F0F\u672A\u6DFB\u52A0\u5230\u684C\u9762"),e&&e.call(null,a);}else e&&e.call(null,!1);},fail:function(i){console.error("\u274C \u68C0\u67E5\u5FEB\u6377\u65B9\u5F0F\u5931\u8D25\uFF0C\u9519\u8BEF\u4FE1\u606F\uFF1A",i),e&&e.call(null,!1);},complete:function(){l.debug("\u{1F51A} \u68C0\u67E5\u5FEB\u6377\u65B9\u5F0F\u63A5\u53E3\u8C03\u7528\u5B8C\u6210");}});}static saveToFavorites(e=null,i=null,a=null){if(!me){l.debug("\u5F53\u524D\u73AF\u5883\u975E\u5FEB\u624B\u5C0F\u6E38\u620F, saveToFavorites \u5931\u8D25");return;}l.debug("KwaiApiTool Saving to Favorites"),_.track("saveToFavorites_cp2sdk"),ks.saveToFavorites({success:function(c){l.debug("KwaiApiTool saveToFavorites success:"+JSON.stringify(c)),e!=null&&e.call(),_.track("saveToFavorites_success");},fail:function(c){l.debug("KwaiApiTool saveToFavorites fail:"+JSON.stringify(c)),i!=null&&i.call();},complete:function(){l.debug("KwaiApiTool saveToFavorites complete"),a!=null&&a.call();}});}};N.unionID="",N.country="",N.language="",N.from="",N.appId="",N.gameVersion="",N.platform="",N.env="",N.brand="",N.model="",N.kwaiSDKVerison="",N.system="",N.ksCode="",N.isGetUserInfo=!1,N.isReport=!1,N.ks_code_key="ks_code_sdk",N.ks_openId_key="ks_openid_sdk",N.cacheKsData={};var C=N;var ve=class{static encode(e){let i="",a=0,c=e.length;for(;a<c;){let w=e[a++]&255,b=a<c?e[a++]&255:NaN,U=a<c?e[a++]&255:NaN,E=w<<16|(isNaN(b)?0:b)<<8|(isNaN(U)?0:U);i+=this.chars[E>>>18&63],i+=this.chars[E>>>12&63],i+=isNaN(b)?"=":this.chars[E>>>6&63],i+=isNaN(U)?"=":this.chars[E&63];}return i;}static decode(e){if(e=e.replace(/[^A-Za-z0-9+/=]/g,""),e.length%4!==0)throw new Error("Invalid base64 string");let i=e.endsWith("==")?2:e.endsWith("=")?1:0,a=e.length*3/4-i,c=new Uint8Array(a),w=0;for(let b=0;b<e.length;b+=4){let U=this.chars.indexOf(e[b]),E=this.chars.indexOf(e[b+1]),B=this.chars.indexOf(e[b+2]),H=this.chars.indexOf(e[b+3]),M=U<<18|E<<12|(B&63)<<6|H&63;w<a&&(c[w++]=M>>>16&255),w<a&&(c[w++]=M>>>8&255),w<a&&(c[w++]=M&255);}return c;}};ve.chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var P=class{static hexToBytes(e){if(e.length%2!==0)throw new Error("Invalid hex string");let i=new Uint8Array(e.length/2);for(let a=0;a<i.length;a++)i[a]=parseInt(e.substr(a*2,2),16);return i;}static stringToBytes(e){return new TextEncoder().encode(e);}static bytesToString(e){return new TextDecoder().decode(e);}static aesGcmEncryptBase64(e,i){if([16,24,32].indexOf(e.length)===-1)throw new Error(`"aes key" expected Uint8Array of length 16/24/32, got length=${e.length}`);let a=NobleCiphers.utils.randomBytes(12),w=NobleCiphers.aes.gcm(e,a).encrypt(i),b=NobleCiphers.utils.concatBytes(a,w);return ve.encode(b);}static aesGcmDecryptBase64(e,i){if([16,24,32].indexOf(e.length)===-1)throw new Error(`"aes key" expected Uint8Array of length 16/24/32, got length=${e.length}`);let a=ve.decode(i);if(a.length<28)throw new Error("encrypted data too short (need nonce12+tag16)");let c=a.subarray(0,12),w=a.subarray(12);return NobleCiphers.aes.gcm(e,c).decrypt(w);}static generateGuid(){let e=NobleCiphers.utils.randomBytes(16);e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=NobleCiphers.utils.bytesToHex(e);return`${i.slice(0,8)}-${i.slice(8,12)}-${i.slice(12,16)}-${i.slice(16,20)}-${i.slice(20)}`;}},D=class{static initialize(e,i,a){this.appkey=i,this.appSecret=a,_.trackDomain(this.url),l.debug(`ConfigService initialized with appkey=${this.appkey}, appSecret=${this.appSecret}`);}static async getKsSession(e){let i=C.getKey(C.ks_openId_key);if(i!==null&&i!==""){this.openId=i,l.debug("use cache openId : ",this.openId);return;}let a={code:e},c="kwaiminigame/code2session";this.getConfig(c,w=>{l.debug("getKsSession result : ",w),this.session_key=w.session_key,this.union_id=w.union_id,w.open_id!==""&&(this.openId=w.open_id,C.saveKey(C.ks_openId_key,w.open_id));},()=>{l.warn("getKsSession failed");},c,a);}static async sendEvt(e,i){let a={event_name:e,event_value:i,sdk_version:C.kwaiSDKVerison,app_id:C.appId,country_code:C.country,language:C.language,os_version:C.system,device_brand:C.brand,device_model:C.model};this.getConfig(this.evtPath,c=>{l.debug("send event result : ",c);},()=>{l.warn("send event failed");},this.evtPath,a);}static async getwithdrawConfig(e){let i={countryCode:C.country},a="withdraw/configs";this.getConfig(a,c=>{l.debug("getwithdrawConfig result : ",JSON.stringify(c,null,2)),e==null||e(c);},()=>{l.warn("getwithdrawConfig failed");},a,i);}static async createOrder(e,i){let a={uniqueId:C.getKey(C.ks_openId_key),countryCode:C.country,sceneId:e,paymentTypeCode:"KWAI_COIN",env:C.env,app_version:C.gameVersion};this.getConfig(this.createOrderPath,c=>{l.debug("createwithdrawConfig result : ",c),i==null||i(!0,c);},()=>{l.warn("createwithdrawConfig failed"),i==null||i(!1,"");},this.createOrderPath,a);}static async getOrder(e){let i={uniqueId:C.getKey(C.ks_openId_key)},a="withdraw/orders";this.getConfig(a,c=>{l.debug("getOrder result : ",JSON.stringify(c,null,2)),e==null||e(c);},()=>{l.warn("getOrder failed");},a,i);}static async getConfig(e,i,a,c="bizconfig",w={}){if(l.debug(`----> Start GET --> [ ${e} ]`),e==null||e.length===0){l.warn("cKey is null or empty, cannot get config"),a==null||a();return;}if(!this.validateConfig()){a==null||a();return;}let b=this.buildRequestData(e,c,w),U=JSON.stringify(b);l.debug(`json : ${U}`);try{let E=P.stringToBytes(this.appSecret),B=P.stringToBytes(U),H=await P.aesGcmEncryptBase64(E,B),M=`${this.appkey}:${this.appSecret}`,x=P.stringToBytes(this.aesKey),Q=P.stringToBytes(M),ce={Authorization:`Bearer ${await P.aesGcmEncryptBase64(x,Q)}`,"Content-Type":"application/octet-stream"},R=Date.now();await this.sendEncryptedRequest(e,P.stringToBytes(H),ce,R,i,a);}catch(E){l.error("\u9519\u8BEF\u540D\u79F0:",E.name),l.error("\u9519\u8BEF\u4FE1\u606F:",E.message),l.error("\u9519\u8BEF\u539F\u56E0:",E.cause),l.error(`\u5806\u6808\u8DDF\u8E2A:
`,E.stack),a==null||a();}}static async getGcmDecryptData(e){try{let i=P.stringToBytes(this.appSecret),a=await P.aesGcmDecryptBase64(i,e);if(a)return P.bytesToString(a);throw new Error("\u89E3\u5BC6\u5931\u8D25");}catch(i){l.error("getGcmDecryptData error :",i);}return"";}static async sendEncryptedRequest(e,i,a,c,w,b){return new Promise((U,E)=>{be.instance.sendRequest(e===this.evtPath?this.url_evt:this.url,"POST",i,(B,H)=>{if(!B){l.warn(`Get Config --> [ ${e} ] Failed!`),b==null||b(),E(new Error("\u8BF7\u6C42\u5931\u8D25"));return;}},async(B,H)=>{let M=Date.now()-c;if(l.debug(`success: ${B}, responseText: ${H}`),!B){l.warn(`Get Config --> [ ${e} ] Network Failed!`),b==null||b(),E(new Error("\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25"));return;}try{let x=P.stringToBytes(this.appSecret),Q=await P.aesGcmDecryptBase64(x,H);if(Q){let se=P.bytesToString(Q);l.debug(`result --> [ ${e} ] : ${se}, time : ${M}ms`),this.onCallBack(se,w,b,e,M),U();}else throw new Error("\u89E3\u5BC6\u5931\u8D25");}catch(x){l.error(`parse data --> [ ${e} ] error :`,x),b==null||b(),E(x);}},15,a);});}static validateConfig(){return!this.url||!this.appkey||!this.appSecret?(l.error("url or appKey or appSecret \u4E3A\u7A7A\uFF0C\u914D\u7F6E\u83B7\u53D6\u5931\u8D25"),!1):this.url.startsWith("http")?!0:(l.error("url\u683C\u5F0F\u9519\u8BEF\uFF0C\u5FC5\u987B\u4EE5http\u5F00\u5934\uFF01"),!1);}static buildRequestData(e,i,a){let w={p:i,d:{bizCode:e}};return i!=="bizconfig"&&(w.d=a),w;}static onCallBack(e,i,a,c,w){l.debug(`callback --> [ ${c} ], time: ${w}ms`);let b="";if(!e){l.debug(`json is null, get config error!!!! ---> key = ${c}`),a==null||a(),this.trackGetCfg(c,w,"json is null, get config error!!!!",!1);return;}let U=null;try{U=JSON.parse(e);}catch{U=null;}if(U){if("code"in U){let E=U.code;if((typeof E=="number"||typeof E=="string")&&Number(E)===0&&(l.debug("result sucess!!!"),c===this.createOrderPath)){i==null||i(U),this.trackGetCfg(c,w,JSON.stringify(U),!0);return;}}if("data"in U){let E=U.data;if(E!=null){let B=JSON.stringify(E);i==null||i(E),this.trackGetCfg(c,w,B,!0);return;}else b=`data is null, get config error!!!! ---> key = ${c}`;}else b=`json has not data, get config error!!!! ---> key = ${c}`;}else b=`json is not a valid json, get config error!!!! ---> key = ${c}`;l.warn(b),a==null||a(),this.trackGetCfg(c,w,b,!1);}static trackGetCfg(e,i,a,c){e!==this.evtPath&&_.trackGetConfig(e,i,a,c);}};D.url="https://api.kwaiminigame.top",D.url_evt="https://sts.kwaiminigame.top",D.appkey="",D.appSecret="",D.aesKey="8b3f5a9e4d1b4f7382f22d9fa8dc4c4e",D.openId="",D.session_key="",D.union_id="",D.evtPath="se",D.createOrderPath="withdraw/createOrder";var Si=(()=>{var O=Object.defineProperty,e=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,c=(t,n)=>{for(var s in n)O(t,s,{get:n[s],enumerable:!0});},w=(t,n,s,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of i(n))!a.call(t,o)&&o!==s&&O(t,o,{get:()=>n[o],enumerable:!(r=e(n,o))||r.enumerable});return t;},b=t=>w(O({},"__esModule",{value:!0}),t),U={};c(U,{default:()=>Gt});var E={};c(E,{abool:()=>H,abytes:()=>x,aexists:()=>Q,anumber:()=>M,aoutput:()=>se,bytesToHex:()=>Ge,bytesToNumberBE:()=>ft,bytesToUtf8:()=>yt,checkOpts:()=>wt,clean:()=>V,complexOverlapBytes:()=>ge,concatBytes:()=>Ce,copyBytes:()=>L,createView:()=>fe,equalBytes:()=>ke,getOutput:()=>oe,hexToBytes:()=>$e,hexToNumber:()=>Pe,isAligned32:()=>$,isBytes:()=>B,isLE:()=>Ne,managedNonce:()=>bt,numberToBytesBE:()=>gt,overlapBytes:()=>Ue,randomBytes:()=>Fe,u32:()=>R,u64Lengths:()=>Me,u8:()=>ce,utf8ToBytes:()=>pt,wrapCipher:()=>te});function B(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array";}function H(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`);}function M(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t);}function x(t,n,s=""){let r=B(t),o=t==null?void 0:t.length,h=n!==void 0;if(!r||h&&o!==n){let u=s&&`"${s}" `,p=h?` of length ${n}`:"",d=r?`length=${o}`:`type=${typeof t}`;throw new Error(u+"expected Uint8Array"+p+", got "+d);}return t;}function Q(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called");}function se(t,n){x(t,void 0,"output");let s=n.outputLen;if(t.length<s)throw new Error("digestInto() expects output buffer of length at least "+s);}function ce(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);}function R(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));}function V(...t){for(let n=0;n<t.length;n++)t[n].fill(0);}function fe(t){return new DataView(t.buffer,t.byteOffset,t.byteLength);}var Ne=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Ke=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ht=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function Ge(t){if(x(t),Ke)return t.toHex();let n="";for(let s=0;s<t.length;s++)n+=ht[t[s]];return n;}var ee={_0:48,_9:57,A:65,F:70,a:97,f:102};function He(t){if(t>=ee._0&&t<=ee._9)return t-ee._0;if(t>=ee.A&&t<=ee.F)return t-(ee.A-10);if(t>=ee.a&&t<=ee.f)return t-(ee.a-10);}function $e(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Ke)return Uint8Array.fromHex(t);let n=t.length,s=n/2;if(n%2)throw new Error("hex string expected, got unpadded hex of length "+n);let r=new Uint8Array(s);for(let o=0,h=0;o<s;o++,h+=2){let u=He(t.charCodeAt(h)),p=He(t.charCodeAt(h+1));if(u===void 0||p===void 0){let d=t[h]+t[h+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+h);}r[o]=u*16+p;}return r;}function Pe(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":"0x"+t);}function ft(t){return Pe(Ge(t));}function gt(t,n){return $e(t.toString(16).padStart(n*2,"0"));}function pt(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t));}function yt(t){return new TextDecoder().decode(t);}function Ue(t,n){return t.buffer===n.buffer&&t.byteOffset<n.byteOffset+n.byteLength&&n.byteOffset<t.byteOffset+t.byteLength;}function ge(t,n){if(Ue(t,n)&&t.byteOffset<n.byteOffset)throw new Error("complex overlap of input and output is not supported");}function Ce(...t){let n=0;for(let r=0;r<t.length;r++){let o=t[r];x(o),n+=o.length;}let s=new Uint8Array(n);for(let r=0,o=0;r<t.length;r++){let h=t[r];s.set(h,o),o+=h.length;}return s;}function wt(t,n){if(n==null||typeof n!="object")throw new Error("options must be defined");return Object.assign(t,n);}function ke(t,n){if(t.length!==n.length)return!1;let s=0;for(let r=0;r<t.length;r++)s|=t[r]^n[r];return s===0;}var te=(t,n)=>{function s(r,...o){if(x(r,void 0,"key"),!Ne)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){let f=o[0];x(f,t.varSizeNonce?void 0:t.nonceLength,"nonce");}let h=t.tagLength;h&&o[1]!==void 0&&x(o[1],void 0,"AAD");let u=n(r,...o),p=(f,g)=>{if(g!==void 0){if(f!==2)throw new Error("cipher output not supported");x(g,void 0,"output");}},d=!1;return{encrypt(f,g){if(d)throw new Error("cannot encrypt() twice with same key + nonce");return d=!0,x(f),p(u.encrypt.length,g),u.encrypt(f,g);},decrypt(f,g){if(x(f),h&&f.length<h)throw new Error('"ciphertext" expected length bigger than tagLength='+h);return p(u.decrypt.length,g),u.decrypt(f,g);}};}return Object.assign(s,t),s;};function oe(t,n,s=!0){if(n===void 0)return new Uint8Array(t);if(n.length!==t)throw new Error('"output" expected Uint8Array of length '+t+", got: "+n.length);if(s&&!$(n))throw new Error("invalid output, must be aligned");return n;}function Me(t,n,s){H(s);let r=new Uint8Array(16),o=fe(r);return o.setBigUint64(0,BigInt(n),s),o.setBigUint64(8,BigInt(t),s),r;}function $(t){return t.byteOffset%4===0;}function L(t){return Uint8Array.from(t);}function Fe(t=32){let n=typeof globalThis=="object"?globalThis.crypto:null;if(typeof(n==null?void 0:n.getRandomValues)!="function")throw new Error("crypto.getRandomValues must be defined");return n.getRandomValues(new Uint8Array(t));}function bt(t,n=Fe){let{nonceLength:s}=t;M(s);let r=(o,h)=>{let u=Ce(o,h);return h.fill(0),u;};return(o,...h)=>({encrypt(u){x(u);let p=n(s),d=t(o,p,...h).encrypt(u);return d instanceof Promise?d.then(f=>r(p,f)):r(p,d);},decrypt(u){x(u);let p=u.subarray(0,s),d=u.subarray(s);return t(o,p,...h).decrypt(d);}});}var ze={};c(ze,{aeskw:()=>Dt,aeskwp:()=>Vt,cbc:()=>Ut,cfb:()=>Ct,ctr:()=>Te,ecb:()=>Rt,gcm:()=>Ot,gcmsiv:()=>st,rngAesCtrDrbg128:()=>Bt,rngAesCtrDrbg256:()=>Nt,siv:()=>qt,unsafe:()=>Kt});var ie=16,Oe=new Uint8Array(16),Z=R(Oe),mt=225,vt=(t,n,s,r)=>{let o=r&1;return{s3:s<<31|r>>>1,s2:n<<31|s>>>1,s1:t<<31|n>>>1,s0:t>>>1^mt<<24&-(o&1)};},W=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function kt(t){t.reverse();let n=t[15]&1,s=0;for(let r=0;r<t.length;r++){let o=t[r];t[r]=o>>>1|s,s=(o&1)<<7;}return t[0]^=-n&225,t;}var St=t=>t>64*1024?8:t>1024?4:2,je=class{constructor(t,n){F(this,"blockLen",ie);F(this,"outputLen",ie);F(this,"s0",0);F(this,"s1",0);F(this,"s2",0);F(this,"s3",0);F(this,"finished",!1);F(this,"t");F(this,"W");F(this,"windowSize");x(t,16,"key"),t=L(t);let s=fe(t),r=s.getUint32(0,!1),o=s.getUint32(4,!1),h=s.getUint32(8,!1),u=s.getUint32(12,!1),p=[];for(let v=0;v<128;v++)p.push({s0:W(r),s1:W(o),s2:W(h),s3:W(u)}),({s0:r,s1:o,s2:h,s3:u}=vt(r,o,h,u));let d=St(n||1024);if(![1,2,4,8].includes(d))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=d;let f=128/d,g=this.windowSize=2**d,y=[];for(let v=0;v<f;v++)for(let k=0;k<g;k++){let m=0,A=0,S=0,I=0;for(let T=0;T<d;T++){if(!(k>>>d-T-1&1))continue;let{s0:q,s1:G,s2:j,s3:ae}=p[d*v+T];m^=q,A^=G,S^=j,I^=ae;}y.push({s0:m,s1:A,s2:S,s3:I});}this.t=y;}_updateBlock(t,n,s,r){t^=this.s0,n^=this.s1,s^=this.s2,r^=this.s3;let{W:o,t:h,windowSize:u}=this,p=0,d=0,f=0,g=0,y=(1<<o)-1,v=0;for(let k of[t,n,s,r])for(let m=0;m<4;m++){let A=k>>>8*m&255;for(let S=8/o-1;S>=0;S--){let I=A>>>o*S&y,{s0:T,s1:q,s2:G,s3:j}=h[v*u+I];p^=T,d^=q,f^=G,g^=j,v+=1;}}this.s0=p,this.s1=d,this.s2=f,this.s3=g;}update(t){Q(this),x(t),t=L(t);let n=R(t),s=Math.floor(t.length/ie),r=t.length%ie;for(let o=0;o<s;o++)this._updateBlock(n[o*4+0],n[o*4+1],n[o*4+2],n[o*4+3]);return r&&(Oe.set(t.subarray(s*ie)),this._updateBlock(Z[0],Z[1],Z[2],Z[3]),V(Z)),this;}destroy(){let{t}=this;for(let n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0;}digestInto(t){Q(this),se(t,this),this.finished=!0;let{s0:n,s1:s,s2:r,s3:o}=this,h=R(t);return h[0]=n,h[1]=s,h[2]=r,h[3]=o,t;}digest(){let t=new Uint8Array(ie);return this.digestInto(t),this.destroy(),t;}},At=class extends je{constructor(t,n){x(t);let s=kt(L(t));super(s,n),V(s);}update(t){Q(this),x(t),t=L(t);let n=R(t),s=t.length%ie,r=Math.floor(t.length/ie);for(let o=0;o<r;o++)this._updateBlock(W(n[o*4+3]),W(n[o*4+2]),W(n[o*4+1]),W(n[o*4+0]));return s&&(Oe.set(t.subarray(r*ie)),this._updateBlock(W(Z[3]),W(Z[2]),W(Z[1]),W(Z[0])),V(Z)),this;}digestInto(t){Q(this),se(t,this),this.finished=!0;let{s0:n,s1:s,s2:r,s3:o}=this,h=R(t);return h[0]=n,h[1]=s,h[2]=r,h[3]=o,t.reverse();}};function Je(t){let n=(r,o)=>t(o,r.length).update(r).digest(),s=t(new Uint8Array(16),0);return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=(r,o)=>t(r,o),n;}var We=Je((t,n)=>new je(t,n)),It=Je((t,n)=>new At(t,n)),J=16,qe=4,Se=new Uint8Array(J),xt=283;function Qe(t){if(![16,24,32].includes(t.length))throw new Error('"aes key" expected Uint8Array of length 16/24/32, got length='+t.length);}function De(t){return t<<1^xt&-(t>>7);}function de(t,n){let s=0;for(;n>0;n>>=1)s^=t&-(n&1),t=De(t);return s;}var Ae=(t,n,s=1)=>{if(!Number.isSafeInteger(s))throw new Error("incBytes: wrong carry "+s);x(t);for(let r=0;r<t.length;r++){let o=n?r:t.length-1-r;s=s+(t[o]&255)|0,t[o]=s&255,s>>>=8;}},Ve=(()=>{let t=new Uint8Array(256);for(let s=0,r=1;s<256;s++,r^=De(r))t[s]=r;let n=new Uint8Array(256);n[0]=99;for(let s=0;s<255;s++){let r=t[255-s];r|=r<<8,n[t[s]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255;}return V(t),n;})(),Tt=Ve.map((t,n)=>Ve.indexOf(n)),Et=t=>t<<24|t>>>8,Le=t=>t<<8|t>>>24,Ie=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function Ze(t,n){if(t.length!==256)throw new Error("Wrong sbox length");let s=new Uint32Array(256).map((f,g)=>n(t[g])),r=s.map(Le),o=r.map(Le),h=o.map(Le),u=new Uint32Array(256*256),p=new Uint32Array(256*256),d=new Uint16Array(256*256);for(let f=0;f<256;f++)for(let g=0;g<256;g++){let y=f*256+g;u[y]=s[f]^r[g],p[y]=o[f]^h[g],d[y]=t[f]<<8|t[g];}return{sbox:t,sbox2:d,T0:s,T1:r,T2:o,T3:h,T01:u,T23:p};}var Be=Ze(Ve,t=>de(t,3)<<24|t<<16|t<<8|de(t,2)),Xe=Ze(Tt,t=>de(t,11)<<24|de(t,13)<<16|de(t,9)<<8|de(t,14)),_t=(()=>{let t=new Uint8Array(16);for(let n=0,s=1;n<16;n++,s=De(s))t[n]=s;return t;})();function X(t){x(t);let n=t.length;Qe(t);let{sbox2:s}=Be,r=[];$(t)||r.push(t=L(t));let o=R(t),h=o.length,u=d=>Y(s,d,d,d,d),p=new Uint32Array(n+28);p.set(o);for(let d=h;d<p.length;d++){let f=p[d-1];d%h===0?f=u(Et(f))^_t[d/h-1]:h>6&&d%h===4&&(f=u(f)),p[d]=p[d-h]^f;}return V(...r),p;}function xe(t){let n=X(t),s=n.slice(),r=n.length,{sbox2:o}=Be,{T0:h,T1:u,T2:p,T3:d}=Xe;for(let f=0;f<r;f+=4)for(let g=0;g<4;g++)s[f+g]=n[r-f-4+g];V(n);for(let f=4;f<r-4;f++){let g=s[f],y=Y(o,g,g,g,g);s[f]=h[y&255]^u[y>>>8&255]^p[y>>>16&255]^d[y>>>24];}return s;}function ne(t,n,s,r,o,h){return t[s<<8&65280|r>>>8&255]^n[o>>>8&65280|h>>>24&255];}function Y(t,n,s,r,o){return t[n&255|s&65280]|t[r>>>16&255|o>>>16&65280]<<16;}function z(t,n,s,r,o){let{sbox2:h,T01:u,T23:p}=Be,d=0;n^=t[d++],s^=t[d++],r^=t[d++],o^=t[d++];let f=t.length/4-2;for(let m=0;m<f;m++){let A=t[d++]^ne(u,p,n,s,r,o),S=t[d++]^ne(u,p,s,r,o,n),I=t[d++]^ne(u,p,r,o,n,s),T=t[d++]^ne(u,p,o,n,s,r);n=A,s=S,r=I,o=T;}let g=t[d++]^Y(h,n,s,r,o),y=t[d++]^Y(h,s,r,o,n),v=t[d++]^Y(h,r,o,n,s),k=t[d++]^Y(h,o,n,s,r);return{s0:g,s1:y,s2:v,s3:k};}function pe(t,n,s,r,o){let{sbox2:h,T01:u,T23:p}=Xe,d=0;n^=t[d++],s^=t[d++],r^=t[d++],o^=t[d++];let f=t.length/4-2;for(let m=0;m<f;m++){let A=t[d++]^ne(u,p,n,o,r,s),S=t[d++]^ne(u,p,s,n,o,r),I=t[d++]^ne(u,p,r,s,n,o),T=t[d++]^ne(u,p,o,r,s,n);n=A,s=S,r=I,o=T;}let g=t[d++]^Y(h,n,o,r,s),y=t[d++]^Y(h,s,n,o,r),v=t[d++]^Y(h,r,s,n,o),k=t[d++]^Y(h,o,r,s,n);return{s0:g,s1:y,s2:v,s3:k};}function Ye(t,n,s,r){x(n,J,"nonce"),x(s);let o=s.length;r=oe(o,r),ge(s,r);let h=n,u=R(h),{s0:p,s1:d,s2:f,s3:g}=z(t,u[0],u[1],u[2],u[3]),y=R(s),v=R(r);for(let m=0;m+4<=y.length;m+=4)v[m+0]=y[m+0]^p,v[m+1]=y[m+1]^d,v[m+2]=y[m+2]^f,v[m+3]=y[m+3]^g,Ae(h,!1,1),({s0:p,s1:d,s2:f,s3:g}=z(t,u[0],u[1],u[2],u[3]));let k=J*Math.floor(y.length/qe);if(k<o){let m=new Uint32Array([p,d,f,g]),A=ce(m);for(let S=k,I=0;S<o;S++,I++)r[S]=s[S]^A[I];V(m);}return r;}function ue(t,n,s,r,o){x(s,J,"nonce"),x(r),o=oe(r.length,o);let h=s,u=R(h),p=fe(h),d=R(r),f=R(o),g=n?0:12,y=r.length,v=p.getUint32(g,n),{s0:k,s1:m,s2:A,s3:S}=z(t,u[0],u[1],u[2],u[3]);for(let T=0;T+4<=d.length;T+=4)f[T+0]=d[T+0]^k,f[T+1]=d[T+1]^m,f[T+2]=d[T+2]^A,f[T+3]=d[T+3]^S,v=v+1>>>0,p.setUint32(g,v,n),({s0:k,s1:m,s2:A,s3:S}=z(t,u[0],u[1],u[2],u[3]));let I=J*Math.floor(d.length/qe);if(I<y){let T=new Uint32Array([k,m,A,S]),q=ce(T);for(let G=I,j=0;G<y;G++,j++)o[G]=r[G]^q[j];V(T);}return o;}var Te=te({blockSize:16,nonceLength:16},function(t,n){function s(r,o){if(x(r),o!==void 0&&(x(o),!$(o)))throw new Error("unaligned destination");let h=X(t),u=L(n),p=[h,u];$(r)||p.push(r=L(r));let d=Ye(h,u,r,o);return V(...p),d;}return{encrypt:(r,o)=>s(r,o),decrypt:(r,o)=>s(r,o)};});function et(t){if(x(t),t.length%J!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size "+J);}function tt(t,n,s){x(t);let r=t.length,o=r%J;if(!n&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");$(t)||(t=L(t));let h=R(t);if(n){let p=J-o;p||(p=J),r=r+p;}s=oe(r,s),ge(t,s);let u=R(s);return{b:h,o:u,out:s};}function it(t,n){if(!n)return t;let s=t.length;if(!s)throw new Error("aes/pcks5: empty ciphertext not allowed");let r=t[s-1];if(r<=0||r>16)throw new Error("aes/pcks5: wrong padding");let o=t.subarray(0,-r);for(let h=0;h<r;h++)if(t[s-h-1]!==r)throw new Error("aes/pcks5: wrong padding");return o;}function nt(t){let n=new Uint8Array(16),s=R(n);n.set(t);let r=J-t.length;for(let o=J-r;o<J;o++)n[o]=r;return s;}var Rt=te({blockSize:16},function(t,n={}){let s=!n.disablePadding;return{encrypt(r,o){let{b:h,o:u,out:p}=tt(r,s,o),d=X(t),f=0;for(;f+4<=h.length;){let{s0:g,s1:y,s2:v,s3:k}=z(d,h[f+0],h[f+1],h[f+2],h[f+3]);u[f++]=g,u[f++]=y,u[f++]=v,u[f++]=k;}if(s){let g=nt(r.subarray(f*4)),{s0:y,s1:v,s2:k,s3:m}=z(d,g[0],g[1],g[2],g[3]);u[f++]=y,u[f++]=v,u[f++]=k,u[f++]=m;}return V(d),p;},decrypt(r,o){et(r);let h=xe(t);o=oe(r.length,o);let u=[h];$(r)||u.push(r=L(r)),ge(r,o);let p=R(r),d=R(o);for(let f=0;f+4<=p.length;){let{s0:g,s1:y,s2:v,s3:k}=pe(h,p[f+0],p[f+1],p[f+2],p[f+3]);d[f++]=g,d[f++]=y,d[f++]=v,d[f++]=k;}return V(...u),it(o,s);}};}),Ut=te({blockSize:16,nonceLength:16},function(t,n,s={}){let r=!s.disablePadding;return{encrypt(o,h){let u=X(t),{b:p,o:d,out:f}=tt(o,r,h),g=n,y=[u];$(g)||y.push(g=L(g));let v=R(g),k=v[0],m=v[1],A=v[2],S=v[3],I=0;for(;I+4<=p.length;)k^=p[I+0],m^=p[I+1],A^=p[I+2],S^=p[I+3],({s0:k,s1:m,s2:A,s3:S}=z(u,k,m,A,S)),d[I++]=k,d[I++]=m,d[I++]=A,d[I++]=S;if(r){let T=nt(o.subarray(I*4));k^=T[0],m^=T[1],A^=T[2],S^=T[3],({s0:k,s1:m,s2:A,s3:S}=z(u,k,m,A,S)),d[I++]=k,d[I++]=m,d[I++]=A,d[I++]=S;}return V(...y),f;},decrypt(o,h){et(o);let u=xe(t),p=n,d=[u];$(p)||d.push(p=L(p));let f=R(p);h=oe(o.length,h),$(o)||d.push(o=L(o)),ge(o,h);let g=R(o),y=R(h),v=f[0],k=f[1],m=f[2],A=f[3];for(let S=0;S+4<=g.length;){let I=v,T=k,q=m,G=A;v=g[S+0],k=g[S+1],m=g[S+2],A=g[S+3];let{s0:j,s1:ae,s2:le,s3:he}=pe(u,v,k,m,A);y[S++]=j^I,y[S++]=ae^T,y[S++]=le^q,y[S++]=he^G;}return V(...d),it(h,r);}};}),Ct=te({blockSize:16,nonceLength:16},function(t,n){function s(r,o,h){x(r);let u=r.length;if(h=oe(u,h),Ue(r,h))throw new Error("overlapping src and dst not supported.");let p=X(t),d=n,f=[p];$(d)||f.push(d=L(d)),$(r)||f.push(r=L(r));let g=R(r),y=R(h),v=o?y:g,k=R(d),m=k[0],A=k[1],S=k[2],I=k[3];for(let q=0;q+4<=g.length;){let{s0:G,s1:j,s2:ae,s3:le}=z(p,m,A,S,I);y[q+0]=g[q+0]^G,y[q+1]=g[q+1]^j,y[q+2]=g[q+2]^ae,y[q+3]=g[q+3]^le,m=v[q++],A=v[q++],S=v[q++],I=v[q++];}let T=J*Math.floor(g.length/qe);if(T<u){({s0:m,s1:A,s2:S,s3:I}=z(p,m,A,S,I));let q=ce(new Uint32Array([m,A,S,I]));for(let G=T,j=0;G<u;G++,j++)h[G]=r[G]^q[j];V(q);}return V(...f),h;}return{encrypt:(r,o)=>s(r,!0,o),decrypt:(r,o)=>s(r,!1,o)};});function rt(t,n,s,r,o){let h=o?o.length:0,u=t.create(s,r.length+h);o&&u.update(o);let p=Me(8*r.length,8*h,n);u.update(r),u.update(p);let d=u.digest();return V(p),d;}var Ot=te({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(t,n,s){if(n.length<8)throw new Error("aes/gcm: invalid nonce length");let r=16;function o(u,p,d){let f=rt(We,!1,u,d,s);for(let g=0;g<p.length;g++)f[g]^=p[g];return f;}function h(){let u=X(t),p=Se.slice(),d=Se.slice();if(ue(u,!1,d,d,p),n.length===12)d.set(n);else{let g=Se.slice();fe(g).setBigUint64(8,BigInt(n.length*8),!1);let y=We.create(p).update(n).update(g);y.digestInto(d),y.destroy();}let f=ue(u,!1,d,Se);return{xk:u,authKey:p,counter:d,tagMask:f};}return{encrypt(u){let{xk:p,authKey:d,counter:f,tagMask:g}=h(),y=new Uint8Array(u.length+r),v=[p,d,f,g];$(u)||v.push(u=L(u)),ue(p,!1,f,u,y.subarray(0,u.length));let k=o(d,g,y.subarray(0,y.length-r));return v.push(k),y.set(k,u.length),V(...v),y;},decrypt(u){let{xk:p,authKey:d,counter:f,tagMask:g}=h(),y=[p,d,g,f];$(u)||y.push(u=L(u));let v=u.subarray(0,-r),k=u.subarray(-r),m=o(d,g,v);if(y.push(m),!ke(m,k))throw new Error("aes/gcm: invalid ghash tag");let A=ue(p,!1,f,v);return V(...y),A;}};}),Ee=(t,n,s)=>r=>{if(!Number.isSafeInteger(r)||n>r||r>s){let o="["+n+".."+s+"]";throw new Error(""+t+": expected value in range "+o+", got "+r);}},st=te({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(t,n,s){let r=Ee("AAD",0,68719476736),o=Ee("plaintext",0,2**36),h=Ee("nonce",12,12),u=Ee("ciphertext",16,2**36+16);x(t),Qe(t),h(n.length),s!==void 0&&r(s.length);function p(){let g=X(t),y=new Uint8Array(t.length),v=new Uint8Array(16),k=[g,y],m=n;$(m)||k.push(m=L(m));let A=R(m),S=0,I=A[0],T=A[1],q=A[2],G=0;for(let ae of[v,y].map(R)){let le=R(ae);for(let he=0;he<le.length;he+=2){let{s0:Ht,s1:$t}=z(g,S,I,T,q);le[he+0]=Ht,le[he+1]=$t,S=++G;}}let j={authKey:v,encKey:X(y)};return V(...k),j;}function d(g,y,v){let k=rt(It,!0,y,v,s);for(let q=0;q<12;q++)k[q]^=n[q];k[15]&=127;let m=R(k),A=m[0],S=m[1],I=m[2],T=m[3];return({s0:A,s1:S,s2:I,s3:T}=z(g,A,S,I,T)),m[0]=A,m[1]=S,m[2]=I,m[3]=T,k;}function f(g,y,v){let k=L(y);k[15]|=128;let m=ue(g,!0,k,v);return V(k),m;}return{encrypt(g){o(g.length);let{encKey:y,authKey:v}=p(),k=d(y,v,g),m=[y,v,k];$(g)||m.push(g=L(g));let A=new Uint8Array(g.length+16);return A.set(k,g.length),A.set(f(y,k,g)),V(...m),A;},decrypt(g){u(g.length);let y=g.subarray(-16),{encKey:v,authKey:k}=p(),m=[v,k];$(g)||m.push(g=L(g));let A=f(v,y,g.subarray(0,-16)),S=d(v,k,A);if(m.push(S),!ke(y,S))throw V(...m),new Error("invalid polyval tag");return V(...m),A;}};}),qt=st;function ot(t){return t instanceof Uint32Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint32Array";}function at(t,n){if(x(n,16,"block"),!ot(t))throw new Error("_encryptBlock accepts result of expandKeyLE");let s=R(n),{s0:r,s1:o,s2:h,s3:u}=z(t,s[0],s[1],s[2],s[3]);return s[0]=r,s[1]=o,s[2]=h,s[3]=u,n;}function lt(t,n){if(x(n,16,"block"),!ot(t))throw new Error("_decryptBlock accepts result of expandKeyLE");let s=R(n),{s0:r,s1:o,s2:h,s3:u}=pe(t,s[0],s[1],s[2],s[3]);return s[0]=r,s[1]=o,s[2]=h,s[3]=u,n;}var _e={encrypt(t,n){if(n.length>=2**32)throw new Error("plaintext should be less than 4gb");let s=X(t);if(n.length===16)at(s,n);else{let r=R(n),o=r[0],h=r[1];for(let u=0,p=1;u<6;u++)for(let d=2;d<r.length;d+=2,p++){let{s0:f,s1:g,s2:y,s3:v}=z(s,o,h,r[d],r[d+1]);o=f,h=g^Ie(p),r[d]=y,r[d+1]=v;}r[0]=o,r[1]=h;}s.fill(0);},decrypt(t,n){if(n.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");let s=xe(t),r=n.length/8-1;if(r===1)lt(s,n);else{let o=R(n),h=o[0],u=o[1];for(let p=0,d=r*6;p<6;p++)for(let f=r*2;f>=1;f-=2,d--){u^=Ie(d);let{s0:g,s1:y,s2:v,s3:k}=pe(s,h,u,o[f],o[f+1]);h=g,u=y,o[f]=v,o[f+1]=k;}o[0]=h,o[1]=u;}s.fill(0);}},ct=new Uint8Array(8).fill(166),Dt=te({blockSize:8},t=>({encrypt(n){if(!n.length||n.length%8!==0)throw new Error("invalid plaintext length");if(n.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");let s=Ce(ct,n);return _e.encrypt(t,s),s;},decrypt(n){if(n.length%8!==0||n.length<24)throw new Error("invalid ciphertext length");let s=L(n);if(_e.decrypt(t,s),!ke(s.subarray(0,8),ct))throw new Error("integrity check failed");return s.subarray(0,8).fill(0),s.subarray(8);}})),dt=2790873510,Vt=te({blockSize:8},t=>({encrypt(n){if(!n.length)throw new Error("invalid plaintext length");let s=Math.ceil(n.length/8)*8,r=new Uint8Array(8+s);r.set(n,8);let o=R(r);return o[0]=dt,o[1]=Ie(n.length),_e.encrypt(t,r),r;},decrypt(n){if(n.length<16)throw new Error("invalid ciphertext length");let s=L(n),r=R(s);_e.decrypt(t,s);let o=Ie(r[1])>>>0,h=Math.ceil(o/8)*8;if(r[0]!==dt||s.length-8!==h)throw new Error("integrity check failed");for(let u=o;u<h;u++)if(s[8+u]!==0)throw new Error("integrity check failed");return s.subarray(0,8).fill(0),s.subarray(8,8+o);}})),Lt=class{constructor(t,n,s){F(this,"blockLen");F(this,"key");F(this,"nonce");F(this,"state");F(this,"reseedCnt");this.blockLen=Te.blockSize;let r=t/8,o=16;this.state=new Uint8Array(r+o),this.key=this.state.subarray(0,r),this.nonce=this.state.subarray(r,r+o),this.reseedCnt=1,Ae(this.nonce,!1,1),this.addEntropy(n,s);}update(t){if(Te(this.key,this.nonce).encrypt(new Uint8Array(this.state.length),this.state),t){x(t);for(let n=0;n<t.length;n++)this.state[n]^=t[n];}Ae(this.nonce,!1,1);}addEntropy(t,n){x(t,this.state.length,"seed");let s=t.slice();if(n){if(x(n),n.length>s.length)throw new Error("info length is too big");for(let r=0;r<n.length;r++)s[r]^=n[r];}this.update(s),s.fill(0),this.reseedCnt=1;}randomBytes(t,n){if(M(t),this.reseedCnt++>=2**48)throw new Error("entropy exhausted");n&&this.update(n);let s=new Uint8Array(t);return Te(this.key,this.nonce).encrypt(s,s),Ae(this.nonce,!1,Math.ceil(t/this.blockLen)),this.update(n),s;}clean(){this.state.fill(0),this.reseedCnt=0;}},ut=t=>(n,s=void 0)=>new Lt(t,n,s),Bt=ut(128),Nt=ut(256),Kt={expandKeyLE:X,expandKeyDecLE:xe,encrypt:z,decrypt:pe,encryptBlock:at,decryptBlock:lt,ctrCounter:Ye,ctr32:ue};globalThis.NobleCiphers={aes:ze,utils:E};var Gt=globalThis.NobleCiphers;return b(U);})();})();/*! Bundled license information:

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/ /* ----  ---- */(function(){console.log("[KS_SDK] SDK...");var checkCount=0;var maxChecks=10;function checkMount(){checkCount++;var sdk=null;// 
if(typeof globalThis!=="undefined"&&globalThis.KS_SDK)sdk=globalThis.KS_SDK;else if(typeof KSGameGlobal!=="undefined"&&KSGameGlobal.KS_SDK)sdk=KSGameGlobal.KS_SDK;else if(typeof cc!=="undefined"&&cc.KS_SDK)sdk=cc.KS_SDK;else if(typeof window!=="undefined"&&window.KS_SDK)sdk=window.KS_SDK;if(sdk&&sdk.SDKMgr&&sdk.SDKMgr.VERSION){console.log("[KS_SDK]   Version:",sdk.SDKMgr.VERSION,"(:"+checkCount+")");}else if(checkCount<maxChecks){setTimeout(checkMount,300);}else{console.log("[KS_SDK] SDK");}}// SDK
setTimeout(checkMount,800);})();}).call(root);})(// The environment-specific global.
function(){if(typeof globalThis!=='undefined')return globalThis;if(typeof self!=='undefined')return self;if(typeof window!=='undefined')return window;if(typeof global!=='undefined')return global;if(typeof this!=='undefined')return this;return{};}.call(this));